const ez=function(){function e(e){let t=(new DOMParser).parseFromString(e,"text/html").body;return t.firstChild}function t(e){let t="";e.tag&&(t=e.tag,delete e.tag);for(let r of Object.keys(e))t+=`[${r}="${e[r]}"]`;return t}function r(e,t=document){let r=[],i="ez-select-"+c();return t.querySelectorAll(e).forEach(e=>e.classList.add(i)),t.querySelectorAll(e).forEach(e=>{r.push(t.querySelector(`.${i}`)),e.classList.remove(i)}),r}function i(e,t){e.__selected__||ez.select(e).core.forEach(t),e.core.forEach(t)}function n(e){return JSON.parse(JSON.stringify(e))}function s(t){return t=e(t.outerHTML),t.setAttribute("ez-uid",c()),t}function c(){return(+new Date*Math.round(Math.random()*Math.pow(10,10))).toString(36)}function a(e,t,r){if(t){let i=e;e=n(t),e.tag=i,e.text=r}else e=n(e);if(e.tag||console.trace(e),!e.tag)throw new Error("Tag is not present in EZ Component declaration");let i=e.tag,s=e.html||e.text&&e.text.replace(/</g,"&lt;").replace(/>/g,"&gt;")||"";return delete e.tag,e.hasOwnProperty("html")&&delete e.html,e.hasOwnProperty("text")&&delete e.text,_={tag:i,html:s,prop:e},h(_)}function h(e){e=n(e);let t=document.createElement(e.tag);t.innerHTML=e.html;for(let r in e.prop)t.setAttribute(r,e.prop[r]);return t}function l(t,r){let i=!1,n=c();t instanceof u?(t=t.main,r&&(t=t.cloneNode(!0)),i=!0):t instanceof HTMLElement&&document.body.contains(t)?(r&&(t.setAttribute("ez-id",n),t.setAttribute("ez-uid",c()),t=t.cloneNode(!0),t.removeAttribute("ez-uid")),i=!0):t instanceof HTMLElement||("object"==typeof t?t=h(t):"string"==typeof t&&(t=t.startsWith("<")?e(t):document.createElement(t)));try{r?t.setAttribute("ez-id",n):t.getAttribute("ez-id")||i||t.setAttribute("ez-id",n)}catch(e){throw new Error(`Element "${t.tagName||"unkown"}" cannot be made into an EZComponent`)}return t}function o(e){return e instanceof u?`[ez-id="${e.attr("ez-id")}"]`:"object"==typeof e?t(e):e}const d={};class m{constructor(){let e=Object.getPrototypeOf(this).constructor,t=d[e]||c();return d.hasOwnProperty(e)||(d[e]=t),ez.create(this.render(...arguments)).ezid(t)}}class u{constructor(e){this.core=[],this.__selected__=!1,this.__create__(e)}get render(){return this.main.render}set render(e){this.main.render=e}__create__(e){this.core.push(e)}tag(){return this.main.tagName.toLowerCase()}id(e){return e?(this.main.id=e,this):this.main.id}ezid(e){return e?(i(this,t=>t.setAttribute("ez-id",e)),this):this.main.getAttribute("ez-id")}ezuid(e){return e?ez.select(`[ez-uid="${e}"]`):ez.select(this).main.getAttribute("ez-uid")}className(e){return e?(i(this,t=>t.setAttribute("class",e)),this):this.main.getAttribute("class")}html(e){return e?(i(this,t=>t.innerHTML=e),this):this.main.innerHTML}text(e){return e?(i(this,t=>t.innerText=e),this):this.main.innerText}raw(e){return e?(this.__selected__?i(this,t=>t.replaceWith(ez.create(e).removeAttr("ez-id").main)):i(this,t=>t.replaceWith(ez.create(e).setAttribute("ez-id",this.getAttribute("ez-id")).main)),this):this.main.outerHTML}simple(){let e=this.main.tagName.toLowerCase(),t=this.main.innerHTML;return-1!==this.main.outerHTML.indexOf("/")?`<${e}>${t}</${e}>`:`<${e}/>`}attr(e,t){return t?(i(this,r=>r.setAttribute(e,t)),this):this.main.getAttribute(e)}hasAttr(e){return!!this.main.getAttribute(e)}removeAttr(e){return i(this,t=>t.removeAttribute(e)),this}data(e,t){return t?(i(this,r=>r.setAttribute(`data-${e}`,t)),this):this.main.getAttribute(`data-${e}`)}empty(){return i(this,e=>e.innerText=""),this}addClass(e){return i(this,t=>t.classList.add(e)),this}removeClass(e){return i(this,t=>t.classList.remove(e)),this}toggleClass(e){return i(this,t=>t.classList.toggle(e)),this}hasClass(e){return this.main.classList.contains(e)}index(){return this.__selected__?this.main.parentElement.childArray.indexOf(this.main):ez.select(this).main.parentElement.childArray.indexOf(ez.select(this).main)}eq(e){return this.__selected__?ez.create(this.core[e]).selected(!0):ez.create(ez.select(this).core[e]).selected(!0)}parent(){return this.__selected__?ez.create(this.main.parentElement).selected(!0):ez.create(ez.select(this).main.parentElement)}children(e){return e=o(e),e?this.__selected__?ez.create(r(e,this.main)).selected(!0):ez.create(r(e,ez.select(this).main)).selected(!0):this.__selected__?ez.create(this.main.childArray).selected(!0):ez.create(ez.select(this).main.childArray).selected(!0)}prev(){return this.__selected__?ez.create(this.main.prev).selected(!0):ez.create(ez.select(this).main.prev).selected(!0)}next(){return this.__selected__?ez.create(this.main.next).selected(!0):ez.create(ez.select(this).main.next).selected(!0)}first(){return this.__selected__?ez.create(this.main).selected(!0):ez.create(ez.select(this).main).selected(!0)}last(){return this.__selected__?ez.create(this.core[this.core.length-1]).selected(!0):ez.create(ez.select(this).core[ez.select(this).core.length-1]).selected(!0)}firstChild(){return this.__selected__?ez.create(this.main.children[0]).selected(!0):ez.create(ez.select(this).main.children[0]).selected(!0)}lastChild(){return this.__selected__?ez.create(this.main.children[this.main.children.length-1]).selected(!0):ez.create(ez.select(this).main.children[ez.select(this).main.children.length-1]).selected(!0)}find(e){return e=o(e),this.__selected__?ez.create(this.main.childArray.filter(t=>t.matches(e))).selected(!0):ez.create(ez.select(this).main.childArray.filter(t=>t.matches(e))).selected(!0)}closest(e){return e=o(e),this.__selected__?ez.create(this.main.closest(e)).selected(!0):ez.create(ez.select(this).main.closest(e)).selected(!0)}filter(e){return e=o(e),this.__selected__?ez.create(this.core.filter(t=>t.matches(e))).selected(!0):ez.create(ez.select(this).core.filter(t=>t.matches(e))).selected(!0)}not(e){return e=o(e),this.__selected__?ez.create(this.core.filter(t=>!t.matches(e))).selected(!0):ez.create(ez.select(this).core.filter(t=>!t.matches(e))).selected(!0)}every(e){return e=o(e),this.__selected__?this.core.every(t=>t.matches(e)):ez.select(this).core.every(t=>t.matches(e))}each(e){return this.__selected__?this.core.forEach(e):ez.select(this).core.forEach(e),this}on(){return i(this,e=>{e.addEventListener(...arguments)}),()=>i(this,e=>e.removeEventListener(...arguments))}prependTo(e,t){return t&&this.__selected__?ez.select(e).main.prependChild(this.main):ez.select(e).core.forEach(e=>e.prependChild(s(this.main))),this}appendTo(e,t){return t&&this.__selected__?ez.select(e).main.appendChild(this.main):ez.select(e).core.forEach(e=>e.appendChild(s(this.main))),this}addBefore(e,t){return t&&this.__selected__?ez.select(e).main.parentElement.insertBefore(this.main,ez.select(e).main):ez.select(e).core.forEach(e=>e.parentElement.insertBefore(s(this.main),e)),this}addAfter(e,t){return t&&this.__selected__?ez.select(e).main.parentElement.insertBefore(this.main,ez.select(e).main.nextSibling):ez.select(e).core.forEach(e=>e.parentElement.insertBefore(s(this.main),e.nextSibling)),this}insert(e,t,r){return t||(t=0),r&&this.__selected__?ez.select(e).core.forEach(e=>{-1===t||t>e.childArray.length?e.appendChild(this.main,e):e.insertBefore(this.main,e.childArray[t])}):ez.select(e).core.forEach(e=>{-1===t||t>e.childArray.length?e.appendChild(s(this.main),e):e.insertBefore(s(this.main),e.childArray[t])}),this}moveUp(){return this.__selected__?this.main.prev&&this.main.prev.parentElement&&this.main.prev.parentElement.insertBefore(this.main,this.main.prev):ez.select(this).main.prev&&ez.select(this).main.prev.parentElement&&ez.select(this).main.prev.parentElement.insertBefore(ez.select(this).main,ez.select(this).main.prev),this}moveDown(){return this.__selected__?this.main.next&&this.main.next.parentElement&&this.main.next.parentElement.insertBefore(this.main,this.main.next.nextSibling):ez.select(this).main.next&&ez.select(this).main.next.parentElement&&ez.select(this).main.next.parentElement.insertBefore(ez.select(this).main,ez.select(this).main.next.nextSibling),this}remove(){return this.__selected__?this.core.forEach(e=>e.remove()):ez.select(this).core.forEach(e=>e.remove()),this}link(e,t){if(this.__selected__)throw new Error("Cannot link a target if selected");return e instanceof u?(e.main=this.main,i(e,e=>e.setAttribute("ez-id",this.main.getAttribute("ez-id")))):(e=ez.select(e),t&&e.core.forEach(e=>e.replaceWith(this.main.cloneNode())),i(e,e=>e.setAttribute("ez-id",this.main.getAttribute("ez-id"))),e.core.forEach(e=>e.setAttribute("ez-uid",c()))),this}linkTo(e){if(!(e&&e instanceof u))throw new Error("Component is not an EZComponent");if(e.__selected__)throw new Error("Cannot link to a selected component");if(this.__selected__)throw new Error("Cannot link to a component if selected");return this.main=e.main,i(this,t=>t.setAttribute("ez-id",e.main.getAttribute("ez-id"))),e}clone(){return ez.create(this,!0)}update(){return i(this,e=>e.replaceWith(this.render(...arguments).main)),this}make(){return ez.create(this.render(...arguments)).ezid(this.main.getAttribute("ez-id"))}setRender(e){return i(this,t=>t.render=e),this}selected(e){return!0===e||!1===e?(this.__selected__=!!e,this):this.__selected__}select(){return this.__selected__?this:ez.select(this)}}Object.defineProperty(HTMLElement.prototype,"prev",{get:function(){return this.previousElementSibling}}),Object.defineProperty(HTMLElement.prototype,"next",{get:function(){return this.nextElementSibling}}),Object.defineProperty(HTMLElement.prototype,"childArray",{get:function(){return Array.from(this.children)}}),Object.defineProperty(u.prototype,"main",{get:function(){return this.core[0]},set:function(e){}});let _={Component:m,create:function(e,t,r){let i;if("string"==typeof e&&"object"==typeof t&&"string"==typeof r)e=a(e,t,r||""),i=new u(l(e));else if(!0===t)i=new u(l(e,!0));else if(Array.isArray(e)){i=new u(l("p")),!0===t&&(i.__selected__=!0),i.core=[];for(let t in e)i.core.push(ez.create(e[t]).main)}else e instanceof HTMLElement?(i=new u(l(e,!!t)),i.__selected__=!0):i=new u(l(e));return i},select:function(e){let t,i;return i=e instanceof HTMLElement?[e]:r(o(e)),t=new u(l("p")),t.__selected__=!0,t.core=i,t},make:function(e){return e instanceof u?e.make(Array.from(arguments).slice(1)).setRender(e.render):e.prototype instanceof m?new e(Array.from(arguments).slice(1)).setRender(e.render):void 0},comp:function(e,t){if("function"!=typeof t)throw new Error("Func must be a function");let r=ez.create(e);return r.setRender(t),r},gen:function(){return(+new Date*Math.round(Math.random()*Math.pow(10,10))).toString(36)}};return _}();