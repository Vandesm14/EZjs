const ez=function(){function e(e){let t=(new DOMParser).parseFromString(e,"text/html").body;return t.firstChild}function t(e){let t="";e.tag&&(t=e.tag,delete e.tag);for(let i of Object.keys(e))t+=`[${i}="${e[i]}"]`;return t}function i(e,t=document){let i=[],r="ez-select-"+c();return t.querySelectorAll(e).forEach(e=>e.classList.add(r)),t.querySelectorAll(e).forEach(e=>{i.push(t.querySelector(`.${r}`)),e.classList.remove(r)}),i}function r(e,t){e.__selected__||ez.select(e).core.forEach(t),e.core.forEach(t)}function n(e){return JSON.parse(JSON.stringify(e))}function s(t){return t=e(t.outerHTML),t.setAttribute("ez-uid",c()),t}function c(){return(+new Date*Math.round(Math.random()*Math.pow(10,10))).toString(36)}function a(e,t,i){if(t){let r=e;e=n(t),e.tag=r,e.text=i}else e=n(e);if(e.tag||console.trace(e),!e.tag)throw new Error("Tag is not present in EZ Component declaration");let r=e.tag,s=e.html||e.text&&e.text.replace(/</g,"&lt;").replace(/>/g,"&gt;")||"";return delete e.tag,e.hasOwnProperty("html")&&delete e.html,e.hasOwnProperty("text")&&delete e.text,d={tag:r,html:s,prop:e},h(d)}function h(e){e=n(e);let t=document.createElement(e.tag);t.innerHTML=e.html;for(let i in e.prop)t.setAttribute(i,e.prop[i]);return t}function l(t,i){let r=!1,n=c();t instanceof m?(t=t.main,i&&(t=t.cloneNode(!0)),r=!0):t instanceof HTMLElement&&document.body.contains(t)?(i&&(t.setAttribute("ez-id",n),t.setAttribute("ez-uid",c()),t=t.cloneNode(!0),t.removeAttribute("ez-uid")),r=!0):t instanceof HTMLElement||("object"==typeof t?t=h(t):"string"==typeof t&&(t=t.startsWith("<")?e(t):document.createElement(t)));try{i?t.setAttribute("ez-id",n):t.getAttribute("ez-id")||r||t.setAttribute("ez-id",n)}catch(e){throw new Error(`Element "${t.tagName||"unkown"}" cannot be made into an EZComponent`)}return t}function o(e){return e instanceof m?`[ez-id="${e.attr("ez-id")}"]`:"object"==typeof e?t(e):e}class m{constructor(e){this.core=[],this.__selected__=!1,this.__create__(e),this.make=function(){throw new Error("Make function has not been set")}}__create__(e){this.core.push(e)}tag(){return this.main.tagName.toLowerCase()}id(e){return e?(this.core.main.id=e,this):this.main.id}ezid(e){return e?(r(this,t=>t.setAttribute("ez-id",e)),this):this.main.getAttribute("ez-id")}ezuid(e){return e?ez.select(`[ez-uid="${e}"]`):ez.select(this).main.getAttribute("ez-uid")}className(e){return e?(r(this,t=>t.setAttribute("class",e)),this):this.main.getAttribute("class")}html(e){return e?(r(this,t=>t.innerHTML=e),this):this.main.innerHTML}text(e){return e?(r(this,t=>t.innerText=e),this):this.main.innerText}raw(e){return e?(this.__selected__?r(this,t=>t.replaceWith(ez.create(e).removeAttr("ez-id").main)):r(this,t=>t.replaceWith(ez.create(e).setAttribute("ez-id",this.getAttribute("ez-id")).main)),this):this.main.outerHTML}simple(){let e=this.main.tagName.toLowerCase(),t=this.main.innerHTML;return-1!==this.main.outerHTML.indexOf("/")?`<${e}>${t}</${e}>`:`<${e}/>`}attr(e,t){return t?(r(this,i=>i.setAttribute(e,t)),this):this.main.getAttribute(e)}hasAttr(e){return!!this.main.getAttribute(e)}removeAttr(e){return r(this,t=>t.removeAttribute(e)),this}data(e,t){return t?(r(this,i=>i.setAttribute(`data-${e}`,t)),this):this.main.getAttribute(`data-${e}`)}empty(){return r(this,e=>e.innerText=""),this}addClass(e){return r(this,t=>t.classList.add(e)),this}removeClass(e){return r(this,t=>t.classList.remove(e)),this}toggleClass(e){return r(this,t=>t.classList.toggle(e)),this}hasClass(e){return this.main.classList.contains(e)}index(){return this.__selected__?this.main.parentElement.childArray.indexOf(this.main):ez.select(this).main.parentElement.childArray.indexOf(ez.select(this).main)}eq(e){return this.__selected__?ez.create(this.core[e]).selected(!0):ez.create(ez.select(this).core[e]).selected(!0)}parent(){return this.__selected__?ez.create(this.main.parentElement).selected(!0):ez.create(ez.select(this).main.parentElement)}children(e){return e=o(e),e?this.__selected__?ez.create(i(e,this.main)).selected(!0):ez.create(i(e,ez.select(this).main)).selected(!0):this.__selected__?ez.create(this.main.childArray).selected(!0):ez.create(ez.select(this).main.childArray).selected(!0)}prev(){return this.__selected__?ez.create(this.main.prev).selected(!0):ez.create(ez.select(this).main.prev).selected(!0)}next(){return this.__selected__?ez.create(this.main.next).selected(!0):ez.create(ez.select(this).main.next).selected(!0)}first(){return this.__selected__?ez.create(this.main).selected(!0):ez.create(ez.select(this).main).selected(!0)}last(){return this.__selected__?ez.create(this.core[this.core.length-1]).selected(!0):ez.create(ez.select(this).core[ez.select(this).core.length-1]).selected(!0)}firstChild(){return this.__selected__?ez.create(this.main.children[0]).selected(!0):ez.create(ez.select(this).main.children[0]).selected(!0)}lastChild(){return this.__selected__?ez.create(this.main.children[this.main.children.length-1]).selected(!0):ez.create(ez.select(this).main.children[ez.select(this).main.children.length-1]).selected(!0)}find(e){return e=o(e),this.__selected__?ez.create(this.main.childArray.filter(t=>t.matches(e))).selected(!0):ez.create(ez.select(this).main.childArray.filter(t=>t.matches(e))).selected(!0)}closest(e){return e=o(e),this.__selected__?ez.create(this.main.closest(e)).selected(!0):ez.create(ez.select(this).main.closest(e)).selected(!0)}filter(e){return e=o(e),this.__selected__?ez.create(this.core.filter(t=>t.matches(e))).selected(!0):ez.create(ez.select(this).core.filter(t=>t.matches(e))).selected(!0)}not(e){return e=o(e),this.__selected__?ez.create(this.core.filter(t=>!t.matches(e))).selected(!0):ez.create(ez.select(this).core.filter(t=>!t.matches(e))).selected(!0)}every(e){return e=o(e),this.__selected__?this.core.every(t=>t.matches(e)):ez.select(this).core.every(t=>t.matches(e))}each(e){return this.__selected__?this.core.forEach(e):ez.select(this).core.forEach(e),this}on(){return r(this,e=>{e.addEventListener(...arguments)}),()=>r(this,e=>e.removeEventListener(...arguments))}prependTo(e,t){return t&&this.__selected__?ez.select(e).main.prependChild(this.main):ez.select(e).core.forEach(e=>e.prependChild(s(this.main))),this}appendTo(e,t){return t&&this.__selected__?ez.select(e).main.appendChild(this.main):ez.select(e).core.forEach(e=>e.appendChild(s(this.main))),this}addBefore(e,t){return t&&this.__selected__?ez.select(e).main.parentElement.insertBefore(this.main,ez.select(e).main):ez.select(e).core.forEach(e=>e.parentElement.insertBefore(s(this.main),e)),this}addAfter(e,t){return t&&this.__selected__?ez.select(e).main.parentElement.insertBefore(this.main,ez.select(e).main.nextSibling):ez.select(e).core.forEach(e=>e.parentElement.insertBefore(s(this.main),e.nextSibling)),this}insert(e,t,i){return t||(t=0),i&&this.__selected__?ez.select(e).core.forEach(e=>{-1===t||t>e.childArray.length?e.appendChild(this.main,e):e.insertBefore(this.main,e.childArray[t])}):ez.select(e).core.forEach(e=>{-1===t||t>e.childArray.length?e.appendChild(s(this.main),e):e.insertBefore(s(this.main),e.childArray[t])}),this}moveUp(){return this.__selected__?this.main.prev&&this.main.prev.parentElement&&this.main.prev.parentElement.insertBefore(this.main,this.main.prev):ez.select(this).main.prev&&ez.select(this).main.prev.parentElement&&ez.select(this).main.prev.parentElement.insertBefore(ez.select(this).main,ez.select(this).main.prev),this}moveDown(){return this.__selected__?this.main.next&&this.main.next.parentElement&&this.main.next.parentElement.insertBefore(this.main,this.main.next.nextSibling):ez.select(this).main.next&&ez.select(this).main.next.parentElement&&ez.select(this).main.next.parentElement.insertBefore(ez.select(this).main,ez.select(this).main.next.nextSibling),this}remove(){return this.__selected__?this.core.forEach(e=>e.remove()):ez.select(this).core.forEach(e=>e.remove()),this}link(e,t){if(this.__selected__)throw new Error("Cannot link a target if selected");return e instanceof m?(e.main=this.main,r(e,e=>e.setAttribute("ez-id",this.main.getAttribute("ez-id")))):(e=ez.select(e),t&&e.core.forEach(e=>e.replaceWith(this.main.cloneNode())),r(e,e=>e.setAttribute("ez-id",this.main.getAttribute("ez-id"))),e.core.forEach(e=>e.setAttribute("ez-uid",c()))),this}linkTo(e){if(!(e&&e instanceof m))throw new Error("Component is not an EZComponent");if(e.__selected__)throw new Error("Cannot link to a selected component");if(this.__selected__)throw new Error("Cannot link to a component if selected");return this.main=e.main,r(this,t=>t.setAttribute("ez-id",e.main.getAttribute("ez-id"))),e}clone(){return arguments.length?ez.create(this.make(...arguments),!0).ezid(this.main.getAttribute("ez-id")):ez.create(this,!0)}update(){arguments.length&&ez.select(this).core.forEach(e=>e.replaceWith(this.clone(...arguments).main))}setMake(e){return this.make=e,this}selected(e){return!0===e||!1===e?(this.__selected__=!!e,this):this.__selected__}select(){return this.__selected__?this:ez.select(this)}}Object.defineProperty(HTMLElement.prototype,"prev",{get:function(){return this.previousElementSibling}}),Object.defineProperty(HTMLElement.prototype,"next",{get:function(){return this.nextElementSibling}}),Object.defineProperty(HTMLElement.prototype,"childArray",{get:function(){return Array.from(this.children)}}),Object.defineProperty(m.prototype,"main",{get:function(){return this.core[0]},set:function(e){}});let d={EZComponent:m,create:function(e,t,i){let r;if("string"==typeof e&&"object"==typeof t&&"string"==typeof i)e=a(e,t,i||""),r=new m(l(e));else if(!0===t)r=new m(l(e,!0));else if(Array.isArray(e)){r=new m(l("p")),!0===t&&(r.__selected__=!0),r.core=[];for(let t in e)r.core.push(ez.create(e[t]).main)}else e instanceof HTMLElement?(r=new m(l(e,!!t)),r.__selected__=!0):r=new m(l(e));return r},select:function(e){let t,r;return r=e instanceof HTMLElement?[e]:i(o(e)),t=new m(l("p")),t.__selected__=!0,t.core=r,t},make:function(e){return e.clone(Array.from(arguments).slice(1))},comp:function(e,t){if("function"!=typeof t)throw new Error("Func must be a function");let i=ez.create(e);return i.make=t,i},gen:function(){return(+new Date*Math.round(Math.random()*Math.pow(10,10))).toString(36)}};return d}();